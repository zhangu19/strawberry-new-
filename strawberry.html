<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zhan Gu">
<meta name="dcterms.date" content="2023-10-11">

<title>Stawberries: exploratory data analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="strawberry_files/libs/clipboard/clipboard.min.js"></script>
<script src="strawberry_files/libs/quarto-html/quarto.js"></script>
<script src="strawberry_files/libs/quarto-html/popper.min.js"></script>
<script src="strawberry_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="strawberry_files/libs/quarto-html/anchor.min.js"></script>
<link href="strawberry_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="strawberry_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="strawberry_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="strawberry_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="strawberry_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Stawberries: exploratory data analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Zhan Gu </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 11, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="assignment" class="level1">
<h1>Assignment</h1>
<p>Using our class discussions and this document as a starting point, produce an EDA report. The report should describe the data itself so that readers understand the data sources used in the report and how you cleaned and organized the data for analysis.</p>
<p>The sections below suggest how the report might be organized. The report should be succinct, communicating the information that you believe will be helpful to someone doing a fuller analysis of the data or using the data for model building. Implementation details should be included in commentary that is included in code.</p>
<p>Sections of the document as it was originally presented in class have been commented so that you can see them in the code.</p>
<hr>
<hr>
<section id="data-acquisition-and-assessment" class="level2">
<h2 class="anchored" data-anchor-id="data-acquisition-and-assessment">Data acquisition and assessment</h2>
<ul>
<li>Data sources<br>
</li>
<li>Assumptions and motivations</li>
</ul>
</section>
<section id="data-cleaning-and-organization" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-and-organization">Data cleaning and organization</h2>
<p>Drop Single-Value Columns: Identify and drop columns with a single unique value.</p>
<p>Data Organization: Data is organized by state.</p>
<p>Separate Data by Program: Split the dataset into two data frames, strwb_census and strwb_survey, based on the “CENSUS” and “SURVEY” values in the “Program” column.</p>
<p>Split Composite Columns: Decompose columns such as ‘Data Item’ into separate meaningful columns.</p>
<p>Handle Missing Values: Replaced NA values and footnotes such as ‘(D)’.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<section id="material-about-strawberries" class="level3">
<h3 class="anchored" data-anchor-id="material-about-strawberries">Material about strawberries</h3>
<p><a href="https://med.news.am/eng/news/13621/who-says-strawberries-may-not-be-so-safe-for-you.html">WHO says strawberries may not be so safe for you–2017March16</a></p>
<p><a href="https://www.ewg.org/foodnews/strawberries.php">Pesticides + poison gases = cheap, year-round strawberries 2019March20</a></p>
<p><a href="https://www.cdc.gov/hepatitis/outbreaks/2022/hav-contaminated-food/index.htm">Multistate Outbreak of Hepatitis A Virus Infections Linked to Fresh Organic Strawberries-2022March5</a></p>
<p><a href="https://issuu.com/mechlocal/docs/053123_mech_asf/s/25386339">Strawberry makes list of cancer-fighting foods-2023May31</a></p>
</section>
<section id="technical-references" class="level3">
<h3 class="anchored" data-anchor-id="technical-references">Technical references</h3>
<p>In their handbook <a href="https://cran.r-project.org/doc/contrib/de_Jonge+van_der_Loo-Introduction_to_data_cleaning_with_R.pdf">“An introduction to data cleaning with R” by Edwin de Jonge and Mark van der Loo</a>, de Jonge and van der Loo go into detail about specific data cleaning isssues and how to handle them in R.</p>
<p><a href="https://www.researchgate.net/profile/Heiko-Mueller/publication/228929938_Problems_methods_and_challenges_in_comprehensive_data_cleansing/links/09e415101b58541e2c000000/Problems-methods-and-challenges-in-comprehensive-data-cleansing.pdf">“Problems, Methods, and Challenges in Comprehensive Data Cleansing” by Heiko Müller and Johann-Christoph Freytag</a> is a good companion to the de Jonge and van der Loo handbook, offering additional insights.</p>
</section>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The data</h2>
<p>The data set for this assignment has been selected from: <a href="https://quickstats.nass.usda.gov">USDA_NASS</a> <br> The data have been stored on NASS here: <a href="https://quickstats.nass.usda.gov/results/45FBC825-B104-38E2-9802-839F5F3C7036">USDA_NASS_strawb_2023SEP19</a></p>
<p>Make relevant observations in the document and in your code about data. Add commentary to the code so that anthoer analysts could use or extend your code.</p>
<p>Discusss missing data, inclding how you handled it. Be careful to point out where NA’s are being produced during processing and are not data missing in the original data.</p>
<p>Where it is relevant, include information of how you have organized the data for analysis. It might, for example, be helpful to know that there is both agricultural census data and survey data. It might be helpful to discuss data that appears to be redundant between these two sources.</p>
<p>Make sure you include details in your discussion and in your code about other data and information you used in your work. Cite sources and provide detail that would allow another analyst to reproduce your work.</p>
<!-- Read the file -->
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,314
Columns: 21
$ Program            &lt;chr&gt; "CENSUS", "CENSUS", "CENSUS", "CENSUS", "CENSUS", "…
$ Year               &lt;dbl&gt; 2021, 2021, 2021, 2021, 2021, 2021, 2021, 2021, 202…
$ Period             &lt;chr&gt; "YEAR", "YEAR", "YEAR", "YEAR", "YEAR", "YEAR", "YE…
$ `Week Ending`      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ `Geo Level`        &lt;chr&gt; "STATE", "STATE", "STATE", "STATE", "STATE", "STATE…
$ State              &lt;chr&gt; "ALASKA", "ALASKA", "ALASKA", "ALASKA", "ALASKA", "…
$ `State ANSI`       &lt;chr&gt; "02", "02", "02", "02", "02", "02", "02", "06", "06…
$ `Ag District`      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ `Ag District Code` &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ County             &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ `County ANSI`      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ `Zip Code`         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ Region             &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ watershed_code     &lt;chr&gt; "00000000", "00000000", "00000000", "00000000", "00…
$ Watershed          &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ Commodity          &lt;chr&gt; "STRAWBERRIES", "STRAWBERRIES", "STRAWBERRIES", "ST…
$ `Data Item`        &lt;chr&gt; "STRAWBERRIES, ORGANIC - OPERATIONS WITH SALES", "S…
$ Domain             &lt;chr&gt; "ORGANIC STATUS", "ORGANIC STATUS", "ORGANIC STATUS…
$ `Domain Category`  &lt;chr&gt; "ORGANIC STATUS: (NOP USDA CERTIFIED)", "ORGANIC ST…
$ Value              &lt;chr&gt; "2", "(D)", "(D)", "(D)", "2", "(D)", "(D)", "142",…
$ `CV (%)`           &lt;chr&gt; "(H)", "(D)", "(D)", "(D)", "(H)", "(D)", "(D)", "1…</code></pre>
</div>
</div>
<!-- Remove columns with a single value in all columns -->
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Dropped Single-Value Columns: names and values</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">col_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">col_val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Week Ending</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Geo Level</td>
<td style="text-align: left;">STATE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ag District</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ag District Code</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">County</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">County ANSI</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zip Code</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">watershed_code</td>
<td style="text-align: left;">00000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Watershed</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Commodity</td>
<td style="text-align: left;">STRAWBERRIES</td>
</tr>
</tbody>
</table>


</div>
</div>
<!-- Glimpse of strawberry data after dropping single-value columns. -->
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,314
Columns: 10
$ Program           &lt;chr&gt; "CENSUS", "CENSUS", "CENSUS", "CENSUS", "CENSUS", "C…
$ Year              &lt;dbl&gt; 2021, 2021, 2021, 2021, 2021, 2021, 2021, 2021, 2021…
$ Period            &lt;chr&gt; "YEAR", "YEAR", "YEAR", "YEAR", "YEAR", "YEAR", "YEA…
$ State             &lt;chr&gt; "ALASKA", "ALASKA", "ALASKA", "ALASKA", "ALASKA", "A…
$ `State ANSI`      &lt;chr&gt; "02", "02", "02", "02", "02", "02", "02", "06", "06"…
$ `Data Item`       &lt;chr&gt; "STRAWBERRIES, ORGANIC - OPERATIONS WITH SALES", "ST…
$ Domain            &lt;chr&gt; "ORGANIC STATUS", "ORGANIC STATUS", "ORGANIC STATUS"…
$ `Domain Category` &lt;chr&gt; "ORGANIC STATUS: (NOP USDA CERTIFIED)", "ORGANIC STA…
$ Value             &lt;chr&gt; "2", "(D)", "(D)", "(D)", "2", "(D)", "(D)", "142", …
$ `CV (%)`          &lt;chr&gt; "(H)", "(D)", "(D)", "(D)", "(H)", "(D)", "(D)", "19…</code></pre>
</div>
</div>
<!-- ## Examine the data. How is it organized? -->
<!-- ### Is every line associated with a state? -->
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Every row has value in the State column."</code></pre>
</div>
</div>
<!-- ### Which state has the most rows? -->
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CALIFORNIA"</code></pre>
</div>
</div>
<!-- The data is organized by state.   -->
<!-- The state with the most rows is CALIFORNIA. -->
<!-- ## Examine California data -->
<!-- ### List the composite columns  -->
<!-- Census: Data Item, Domain Category -->
<!-- Survey: Data Item, Domain, Domain Category -->
<!-- ## Separate CENSUS and SURVEY into two Data Frames -->
<!-- In the strawberry data frame,  -->
<!-- The CENSUS rows contains marketing, sales, and productiong data.  The SURVEY rows contain rows which may be redundant with the CENSUS rows and chemical application rows. -->
<!-- After splitting CENSUS and SURVEY rows into two data frames,  -->
<!-- finish organizing the CENSUS data first.  Then, organize the -->
<!-- SURVEY data frame splitting the marketing, and production data from the chemical application data. -->
<!-- # Complete with the census data frame -->
<!-- ## Separate composite columns and clean the Value column -->
<!-- Composite columns in the strwb_census: Data Item, Domain category -->
<!-- Column separators in CENSUS: ",", "-", ":" -->
<!-- ### Separate `Data Item` into columns by "," -->
<!-- ## Create a "Fresh Market" column -->
<!-- ## Create a "Process Market" column -->
<!-- Remove NA's from prop_acct, temp2, and temp3 -->
<!-- Combine temp2 with temp3 to create Metric column -->
<!-- remove  -->
<!-- relocate columns -->
<!-- ## The Value column transformation -->
<!-- NOTE -->
<!-- These plots were in early versions of the classroom notes. -->
<!-- In final versions of this document, they should be included in the EDA section. Note that the code will not run without editing. -->
<!-- ## plots   -->
</section>
<section id="eda" class="level2">
<h2 class="anchored" data-anchor-id="eda">EDA</h2>
<p>Once the data has been cleaned and organized, you must conduct your own EDA. Be sure to include a discussion of your analysis of the chemical information, including citations for data and other information you have used. Visualizations should play a key role in your analysis. Plots should be labeled and captioned.</p>
<!-- ## chemicals -->
<!-- ### carcinogens from WHO list -->
<!-- #### updated -->
<!-- [list from WHO?](https://ggle.io/6Eys) -->
<!-- Arsenic: A Group 1 carcinogen, or conclusive cause of cancer   -->
<!-- Ethylene oxide: A Group 1 carcinogen   -->
<!-- Lindane: A Group 1 carcinogen   -->
<!-- 2,3,7,8-tetrachlorodibenzo-p-dioxin (TCDD): A Group 1 carcinogen   -->
<!-- Diazinon: Classified as "probably carcinogenic"   -->
<!-- Glyphosate: Classified as "probably carcinogenic"    -->
<!-- Malathion: Classified as "probably carcinogenic"   -->
<!-- #### -->
<!-- Now produce two data frames using strwb_survey. -->
<!-- One will have market data similar to strwb_census -->
<!-- The second will have data about chemicals used by  -->
<!-- strawberry growers. -->
<!-- Use the survey market data to enrich the data you already have -->
<!-- from the census.   -->
<!-- Use the chemical data to explore the use of carcinogens to grown strawberries.  Use the World Health Organization's -->
<!-- list of carcinogens.  These lists site specific chemicals.  -->
<!-- For exampe: these chemicals are on WHO's list of known carcinogens: captafol, ethylene dibromide, glyphosate, malathion, diazinon and dichlorophenyltrichloroethane (DDT).   Note that the WHO lists are not specific to strawberries.  You must use available data resources to determine which are used in strawberry growing. -->
<!-- ## Clean and organize strwb_survey -->
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,450
Columns: 10
$ Program           &lt;chr&gt; "SURVEY", "SURVEY", "SURVEY", "SURVEY", "SURVEY", "S…
$ Year              &lt;dbl&gt; 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022…
$ Period            &lt;chr&gt; "MARKETING YEAR", "MARKETING YEAR", "MARKETING YEAR"…
$ State             &lt;chr&gt; "CALIFORNIA", "CALIFORNIA", "CALIFORNIA", "FLORIDA",…
$ `State ANSI`      &lt;chr&gt; "06", "06", "06", "12", "12", "12", NA, NA, NA, "06"…
$ `Data Item`       &lt;chr&gt; "STRAWBERRIES - PRICE RECEIVED, MEASURED IN $ / CWT"…
$ Domain            &lt;chr&gt; "TOTAL", "TOTAL", "TOTAL", "TOTAL", "TOTAL", "TOTAL"…
$ `Domain Category` &lt;chr&gt; "NOT SPECIFIED", "NOT SPECIFIED", "NOT SPECIFIED", "…
$ Value             &lt;chr&gt; "108", "(D)", "(D)", "169", "(D)", "(D)", "0", "135"…
$ `CV (%)`          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …</code></pre>
</div>
</div>
<!-- ## Column analyses -->
<!-- ### Period -->
<!-- data item -->
<!-- Domain -->
<!-- Domain Category -->
<!-- drop 1-value columns strawberry chems  -->
<!-- mkt -->
<p>Chemical Usage in Strawberry Production Strawberries, like many crops, may undergo various chemical treatments to ensure their growth, quality, and protection against pests. However, some of these chemicals may be harmful or even carcinogenic. It’s essential to analyze which chemicals are used.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 10
   Year State      `State ANSI` temp3    temp4 temp23 temp43 temp44 temp45 Value
  &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;
1  2021 CALIFORNIA 06           " MEASU…  &lt;NA&gt; " HER… " HER… &lt;NA&gt;   &lt;NA&gt;   (D)  
2  2021 CALIFORNIA 06           " MEASU…  &lt;NA&gt; " HER… " HER… &lt;NA&gt;   &lt;NA&gt;   (D)  
3  2021 CALIFORNIA 06           " MEASU… " AV… " HER… " HER… &lt;NA&gt;   &lt;NA&gt;   (D)  
4  2021 CALIFORNIA 06           " MEASU… " AV… " HER… " HER… &lt;NA&gt;   &lt;NA&gt;   (D)  
5  2021 CALIFORNIA 06           " MEASU… " AV… " HER… " HER… &lt;NA&gt;   &lt;NA&gt;   (D)  </code></pre>
</div>
</div>
<p style="page-break-before: always">
</p>
<section id="these-references-have-been-left-in-the-document-to-help-while-you-are-writing.-cite-those-you-use-and-drop-the-rest-from-the-final-document." class="level3">
<h3 class="anchored" data-anchor-id="these-references-have-been-left-in-the-document-to-help-while-you-are-writing.-cite-those-you-use-and-drop-the-rest-from-the-final-document.">These references have been left in the document to help while you are writing. Cite those you use and drop the rest from the final document.</h3>
<p><a href="https://quickstats.nass.usda.gov/tutorials">NASS help</a></p>
<p><a href="https://quickstats.nass.usda.gov/src/glossary.pdf">Quick Stats Glossary</a></p>
<p><a href="https://quickstats.nass.usda.gov/param_define">Quick Stats Column Definitions</a></p>
<p><a href="https://www.nass.usda.gov/Statistics_by_Subject/index.php?sector=CROPS">stats by subject</a></p>
<p>for EPA number lookup <a href="https://archive.epa.gov/pesticides/chemicalsearch/chemical/foia/web/html/128810.html">epa numbers</a></p>
<p><a href="https://ordspub.epa.gov/ords/pesticides/f?p=APPRIL_PUBLIC:2::::::">Active Pesticide Product Registration Informational Listing</a></p>
<p>pc number input <a href="https://ordspub.epa.gov/ords/pesticides/f?p=chemicalsearch:1">pesticide chemical search</a></p>
<p><a href="https://comptox.epa.gov/dashboard/">toxic chemical dashboard</a></p>
<p><a href="https://cfpub.epa.gov/si/si_public_record_report.cfm?Lab=NCCT&amp;dirEntryId=209598">ACToR – Aggregated Computational Toxicology Resource</a></p>
<p><a href="https://comptox.epa.gov/dashboard/chemical/details/DTXSID0020315">comptox dashboard</a></p>
<p><a href="https://pubchem.ncbi.nlm.nih.gov/">pubChem</a></p>
<p>The EPA PC (Pesticide Chemical) Code is a unique chemical code number assigned by the EPA to a particular pesticide active ingredient, inert ingredient or mixture of active ingredients.</p>
</section>
</section>
<section id="investigating-toxic-pesticides" class="level2">
<h2 class="anchored" data-anchor-id="investigating-toxic-pesticides">Investigating toxic pesticides</h2>
<p><a href="https://ordspub.epa.gov/ords/pesticides/f?p=chemicalsearch:1">start here with chem PC code</a></p>
<p><a href="https://ordspub.epa.gov/ords/pesticides/f?p=113:1::::RP,17,1::">step 2</a> to get label (with warnings) for products using the chemical</p>
<p><a href="https://www.ilo.org/dyn/icsc/showcard.home">International Chemical safety cards</a></p>
<p><a href="https://ordspub.epa.gov/ords/pesticides/f?p=113:1::::RP,17,1::">Pesticide Product and Label System</a></p>
<p><a href="https://ordspub.epa.gov/ords/pesticides/f?p=113:17::::::">Search by Chemical</a></p>
<p><a href="https://comptox.epa.gov/dashboard/">CompTox Chemicals Dashboard</a></p>
<p><a href="https://ordspub.epa.gov/ords/pesticides/f?p=APPRIL_PUBLIC:2::::::">Active Pesticide Product Registration Informational Listing</a></p>
<p><a href="https://www.osha.gov/chemicaldata">OSHA chemical database</a></p>
<p><a href="http://npic.orst.edu/ingred/">Pesticide Ingredients</a></p>
<p><a href="http://npic.orst.edu/NPRO/">NPIC Product Research Online (NPRO)</a></p>
<p><a href="http://npic.orst.edu/ingred/cheminfo.html">Databases for Chemical Information</a></p>
<p><a href="http://npic.orst.edu/ingred/active.html">Pesticide Active Ingredients</a></p>
<p><a href="https://www.epa.gov/tsca-inventory">TSCA Chemical Substance Inventory</a></p>
<p><a href="https://ordspub.epa.gov/ords/pesticides/f?p=CHEMICALSEARCH:3::::1,3,31,7,12,25:P3_XCHEMICAL_ID:2478">glyphosate</a></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>